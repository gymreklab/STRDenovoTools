# MonSTR: identifying de novo tandem repeat mutations from next-generation sequencing data

Authors:

* Ileena Mitra <ilmitra@ucsd.edu>
* Melissa Gymrek <mgymrek@ucsd.edu> <br>  

License: MIT

MonSTR is a toolkit for identifying and analyzing de novo tandem repeat mutations. The core code for calling de novos and parsing VCF files is modified from that originally written by Thomas Willems in the [HipSTR](https://github.com/tfwillems/HipSTR) repository.

## Install

You can install MonSTR using the following commands:

```
git clone https://github.com/gymreklab/STRDenovoTools  
cd STRDenovoTools
mkdir build
cd build
cmake ..
make
sudo make install
```

You will need to have a C-compiler and cmake installed.

## Basic usage

MonSTR takes as input a VCF file generated by [HipSTR](https://github.com/tfwillems/HipSTR) or [GangSTR](https://github.com/gymreklab/gangstr) and a pedigree file in [.fam](https://www.cog-genomics.org/plink2/formats#fam) format describing family relationships. It outputs text files describing mutation probabilities at each locus in each trio.

**Important** The VCF files must contain genotype likelihoods unless running in naive mode. The VCFs must have been run on all samples in a family jointly so that their genotype likelihood fields contain info for the same set of alleles. See "Preparing your VCF file" below. Sample IDs in the pedigree file must match exactly to those in the VCF header.

Below shows a basic MonSTR command:
```
MonSTR \
    --strvcf test.vcf.gz \
    --fam family.fam \
    --out test
```

Type `MonSTR --help`, or the documentation below, to see more detailed information about which options are available.

## Preparing your VCF file

By default, MonSTR computes a joint likelihood of all possible genotype configurations at each locus in trio. To do so, it must have detailed genotype likelihood information specifying the likelihood of each possible diploid genotype, and the set of possible genotypes considered must be identical in each family member. Therefore, when generating your input VCF file with HipSTR or GangSTR, you must:

* Run HipSTR or GangSTR jointly on all family members. If they are genotyped separately, each VCF file might contain different sets of alternate alleles, making GL fields incomparable across files. Note, you may include multiple families in a single run and output VCF file, as long as families are not split across VCFs.
* If using HipSTR, use the `--output-gls` option to include the GL field in the VCF output. This is a standard VCF fielf for specifying genotype likelihoods (see VCF spec: https://samtools.github.io/hts-specs/VCFv4.2.pdf)
* If using GangSTR, use the `--include-ggl` option to include the GGL field. This is a modified version of the GL field to accommodate the larger number of alternate alleles considered by GangSTR. It is described on the [GangSTR webpage](https://samtools.github.io/hts-specs/VCFv4.2.pdf).

The sample IDs in the VCF output file must match those in the .fam file and should not be repeated across families.

## Filtering options

## Specifying custom mutation models

## Running on chromosmoe X

## Output formats

MonSTR outputs the following files (`<OUTPREFIX>` is specified by the `--out` option):

#### `<OUTPREFIX>.all_mutations.tab`    

This file contains one line per TR per trio. It contains the following columns:

| **chrom** | The chromosome of the TR|
| **pos** | The postion of the TR |
| **period** | The length of the repeat unit (in bp) |
| **prior** | The prior probability of mutation  |
| **family** | The family ID of the trio (taken from the .fam file)
| **child** | The sample ID of the child in the trio |
| **phenotype** | The phenotype of the child, taken from the .fam file |
| **posterior** | The posterior probability of mutation |
| **newallele** | The allele arising from a de novo mutation (number of repeat units). This field is only meaningful if there was a mutation inferred. |
| **mutsize** | The size of the mutation (number of repeat units). This field is only meaningful if there was a mutation inferred. |
| **inparents** | Set to true if the new allele is found in the parents. This field is only meaningful if there was a mutation inferred.
| **poocase** | Gives the inferred parent of origin of the mutation, if a mutation was inferred. 0: unknown; 1: Mendelian (no denovo); 2: New allele from father; 3: New allele from mother; 4: Unclear |



#### `<OUTPREFIX>.locus_summary.tab`    

TODO

## Cite 
If you use this method for your research, please cite:
Mitra, et al. 2020 https://www.biorxiv.org/content/10.1101/2020.03.04.974170v1
